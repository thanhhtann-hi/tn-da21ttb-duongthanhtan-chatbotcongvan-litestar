<!-- file: src/modules/admin/documents/admin_documents_bulk_delete_modal.html -->
<!-- updated: 2025-08-25 (v1.0) -->
<!-- note:
     - Bulk delete (hard-delete) nhiều Văn bản theo danh sách ids.
     - CHỈ swap #documents-list-region (hx-target + hx-select).
     - JS sẽ bơm đủ filter: status/chat_id/q/sort/page/per_page.
-->

{% set COUNT = selected_count or 0 %}
{% set IDS = selected_ids or '' %}

<!-- Overlay (click để đóng) -->
<div id="docs-bulk-delete-modal-overlay"
    class="fixed inset-0 z-[9998] bg-black/70 backdrop-blur-[2px]"></div>

<!-- Modal -->
<div id="docs-bulk-delete-modal" class="fixed inset-0 z-[9999] flex items-center justify-center"
    role="dialog" aria-modal="true" tabindex="-1">
    <div class="docs-modal-content w-full max-w-[98vw] sm:max-w-[520px] rounded-[28px]
              border border-gray-200 bg-white shadow px-0 py-0 flex flex-col
              font-manrope animate-in zoom-in-95">

        <!-- Header -->
        <div class="relative flex items-center justify-center min-h-[56px] px-6 py-4">
            <div class="flex-1 flex flex-col items-center">
                <h2 class="text-lg font-semibold text-red-700 text-center w-full">
                    Xoá nhiều văn bản
                </h2>
                <div class="mt-1 text-sm text-gray-600 text-center">
                    Hành động này sẽ <b>xóa vĩnh viễn</b> các văn bản đã chọn khỏi hệ thống.
                </div>
            </div>

            <!-- Close -->
            <button id="docs-bulk-delete-modal-close" type="button"
                class="absolute right-6 top-1/2 -translate-y-1/2 inline-flex items-center justify-center
                     w-10 h-10 rounded-full ring-1 ring-gray-300 bg-white shadow
                     hover:bg-red-50 hover:ring-red-800 transition-all focus:outline-none"
                aria-label="Đóng">
                <span class="chip-normal flex items-center justify-center w-4 h-4">
                    {% include "partials/icons/admin_header/admin_header_x_den.svg" %}
                </span>
                <span class="chip-hover hidden items-center justify-center w-4 h-4">
                    {% include "partials/icons/admin_header/admin_header_x_do.svg" %}
                </span>
            </button>
        </div>

        <!-- Body -->
        <div class="modal-scroll-area grow overflow-y-auto px-6 pb-6">
            <div class="rounded-xl bg-red-50 text-red-800 border border-red-100 p-4 text-sm">
                <div class="font-semibold">
                    Các mục sẽ bị <span class="font-bold">xoá vĩnh viễn</span>.
                </div>
                <div id="docs-bulk-delete-desc" class="mt-1">
                    Bạn sắp thao tác với
                    <span class="font-bold">{{ COUNT }}</span>
                    văn bản đã chọn.
                </div>
                <div class="mt-1 text-[13px] text-red-700/90">
                    Thao tác <b>không thể hoàn tác</b>. Hãy kiểm tra kỹ trước khi xác nhận.
                </div>
            </div>

            <!-- Form POST bulk-delete -->
            <form id="admin-docs-bulk-delete-form"
                method="POST"
                action="/admin/documents/bulk-delete"
                hx-post="/admin/documents/bulk-delete"
                hx-target="#documents-list-region"
                hx-select="#documents-list-region"
                hx-swap="outerHTML"
                hx-headers='{"X-CSRF-Token":"{{ csrf_token }}"}'
                hx-disabled-elt="#docs-bulk-delete-submit"
                class="mt-5 flex items-center justify-center gap-4"
                data-selected-count="{{ COUNT }}">

                <input type="hidden" name="csrf_token" value="{{ csrf_token }}">
                <!-- Danh sách ID (CSV) -->
                <input type="hidden" name="ids" id="docs-bulk-delete-ids" value="{{ IDS }}">

                <!-- Filter state (JS sẽ set trước submit) -->
                <input type="hidden" name="status" value="">
                <input type="hidden" name="chat_id" value="">
                <input type="hidden" name="q" value="">
                <input type="hidden" name="sort" value="">
                <input type="hidden" name="page" value="">
                <input type="hidden" name="per_page" value="">

                <button type="button" id="docs-bulk-delete-cancel"
                    class="w-[120px] rounded-full py-2.5 bg-gray-200 text-gray-700 font-medium
                       hover:bg-gray-300 focus:outline-none focus:ring-2 focus:ring-gray-300 text-[14px]">
                    Hủy
                </button>

                <button id="docs-bulk-delete-submit" type="submit"
                    class="w-[180px] rounded-full py-2.5 bg-red-700 text-white font-medium
                       hover:bg-red-800 focus:outline-none focus:ring-2 focus:ring-red-300 text-[14px]"
                    {% if not COUNT or COUNT==0 %}disabled{% endif %}>
                    Xoá các văn bản
                </button>
            </form>
        </div>
    </div>
</div>

<style>
    /* Scoped SVG reset */
    #docs-bulk-delete-modal svg {
        width: auto !important;
        height: auto !important;
        max-width: none !important;
        max-height: none !important;
        display: block
    }

    .docs-modal-content {
        box-shadow: 0 10px 32px rgba(0, 0, 0, .13);
        border: 1.5px solid #e5e7eb;
        background: #fff
    }

    /* Hover swap icon (đen → đỏ) */
    #docs-bulk-delete-modal-close .chip-hover {
        display: none
    }

    #docs-bulk-delete-modal-close:hover .chip-normal,
    #docs-bulk-delete-modal-close:focus .chip-normal {
        display: none
    }

    #docs-bulk-delete-modal-close:hover .chip-hover,
    #docs-bulk-delete-modal-close:focus .chip-hover {
        display: flex
    }

    #docs-bulk-delete-modal-close .chip-normal svg,
    #docs-bulk-delete-modal-close .chip-hover svg {
        width: 10px !important;
        height: 10px !important;
        margin: auto;
        display: block;
        line-height: 0
    }

    /* Mobile sheet */
    @media (max-width:540px) {
        #docs-bulk-delete-modal {
            align-items: flex-end !important;
            justify-content: flex-end !important;
            padding: 0 !important
        }

        .docs-modal-content {
            width: 100vw !important;
            max-width: none !important;
            border-radius: 22px 22px 0 0 !important;
            position: fixed !important;
            left: 0;
            right: 0;
            bottom: 0
        }
    }
</style>